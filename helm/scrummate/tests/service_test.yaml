suite: test services
templates:
  - services/services.yaml
tests:
  - it: should create backend service
    set:
      backend.enabled: true
    asserts:
      - hasDocuments:
          count: 2
      - isKind:
          of: Service
        documentIndex: 0
      - equal:
          path: metadata.name
          value: RELEASE-NAME-scrummate-backend
        documentIndex: 0
      - equal:
          path: spec.ports[0].port
          value: 8080
        documentIndex: 0

  - it: should create frontend service
    set:
      frontend.enabled: true
    asserts:
      - isKind:
          of: Service
        documentIndex: 1
      - equal:
          path: metadata.name
          value: RELEASE-NAME-scrummate-frontend
        documentIndex: 1
      - equal:
          path: spec.ports[0].port
          value: 80
        documentIndex: 1

  - it: should set correct service type
    set:
      frontend.enabled: true
      frontend.service.type: LoadBalancer
    asserts:
      - equal:
          path: spec.type
          value: LoadBalancer
        documentIndex: 1
